/*!
 * 
 * SpreadJS Library 13.2.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Hyperlink=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/hyperlink/hyperlink.js")}({"./dist/plugins/hyperlink/hyperlink.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("SheetsCalc"),g=d.Ul.fp,h=d.Ul.Nl,i=d.Ul.ol,j=d.GC$,k=d.Commands.ActionBase,l=d.CellTypes.Base,m=e.Common.j.Fa,n=e.Common.j.C4,o=e.Common.pc,p=void 0,q=null,r=Math.max,s=Math.min,t=Math.floor,u=window.open,v=e.Common.u.kb,w="position",x="absolute",y="margin",z="font",A="left",B="top",C="padding",D="border",E="box-sizing",F="pointer",G="background-color",H="content-box",I="default",J="white",K="div",L="gc-spread-hyperlink-tooltip",M="#0066cc",N="#3399ff",O="hyperlink",P="openUrl",Q="generateHyperlink",R=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,S=/^(mailto:\/\/)?([A-Za-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([A-Za-z0-9\-])+\.([A-Za-z0-9\-]){2,63}(\?subject=.+)?$/gi,T=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi,function(a){a[a.blank=0]="blank",a[a.self=1]="self",a[a.parent=2]="parent",a[a.top=3]="top"}(U=b.HyperlinkTargetType||(b.HyperlinkTargetType={})),d.GC$.extend(d.lUa.prototype,{getHyperlink:function(a,b,c){var d,e;return m(c)&&(c=3),d=this,e=d.XTa(c).RTa(a,b),e&&!m(e.hyperlink)?e.hyperlink:q},setHyperlink:function(a,b,c,d){var e,f,g,h,i,j,k,l=this;if(m(d)&&(d=3),e=c&&c.url,e&&e.match(T)&&e.match(T).length>0?(f="www.",v(e,f)&&(c.url="http://"+e)):e&&e.match(S)&&e.match(S).length>0&&(g="mailto:",v(e,g)||(c.url=g+e)),h=l.WTa>0?[["sheetModels",d],p]:p,i=l.XTa(d).RTa(a,b,!0,h?h[0]:p),m(i))h&&(h.length=0);else{if(j=i.hyperlink,m(c))i.hyperlink=null,delete i.hyperlink;else{i.hyperlink={url:"",linkColor:p,visitedLinkColor:p,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""};for(k in i.hyperlink)c[k]!==p&&(i.hyperlink[k]=c[k])}h&&(h[0].push("hyperlink"),h[1]=j)}h&&h.length>0&&l.zTa.push(h)}}),d.GC$.extend(d.Worksheet.prototype,{getHyperlink:function(a,b,c){var d,e;return 0===c?q:(m(c)&&(c=3),d=this,e=d.ITa,n(e.getHyperlink(a,b,c)))},setHyperlink:function(a,b,c,d){var e,f,g,h;0!==d&&(m(d)&&(d=3),e=this,f=e.ITa,g=f.getRowCount(d),h=f.getColumnCount(d),a<0||a>=g||b<0||b>=h||(f.do("setHyperlink",a,b,c,d),this.$p()))}}),V=function(a){_(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,g,h,i,j,k,l=this,n=l.kj,o=!1,p=l.VQ.url;return m(p)?o:(a=l.VQ.target||0,b="sjs://",0===p.indexOf(b)?(c=b.length,d=f.formulaToRanges(n,p.substring(c),0,0,!0),d&&d.length>0&&(g=d[0].sheetName,h=d[0].ranges[0],g!==n.name()&&(n.parent.setActiveSheet(g),n=n.parent.getActiveSheet()),n.setSelection(h.row,h.col,h.rowCount,h.colCount))):m(p)||(i="mailto:",p.match(T)&&p.match(T).length>0?(j="www.",v(p,j)&&(p="http://"+p)):p.match(S)&&p.match(S).length>0&&(v(p,i)||(p=i+p)),v(p,i)&&e.Common.u.Jb(p,"?")>1&&(k=p.split("?"),p=k[0]+"?"+k.slice(1).join("%3F")),u(p,["_blank","_self","_parent","_top"][a])),o)},b}(k),d.Commands[P]={canUndo:!1,execute:function(a,b,c){return d.Commands.h4(a,V,b,c)}},W=function(a){_(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e=this,f=e.kj,g=e.VQ,h=g.url,i=g.row,j=g.col,k=g.sheetArea;if(null===h)a=null;else{if("string"!=typeof h)return!1;if(b=h.match(T),(!b||b.length<1)&&(b=h.match(S),(!b||b.length<1)&&(b=h.match(R))),!(b&&b.length>0&&0===h.indexOf(b[0])&&h.length===b[0].length))return!1;a={url:h}}return f.ITa.startTransaction(),f.suspendPaint(),f.suspendEvent(),f.setHyperlink(i,j,a,k),f.resumeEvent(),f.resumePaint(),c=d.Commands.bWa(f.name()),e.VQ[c]=f.ITa.endTransaction(),!0},b.prototype.undo=function(){var a,b=this,c=b.kj;return c.suspendPaint(),c.suspendEvent(),a=d.Commands.bWa(c.name()),c.ITa.undo(this.VQ[a]),c.resumeEvent(),c.resumePaint(),!0},b}(k),d.Commands[Q]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,W,b,c)}},X={init:function(){this.commandManager().register(P,d.Commands[P]),this.commandManager().register(Q,d.Commands[Q])}},d.Workbook.$n(O,X),Y={setHyperlinkWhenEditing:function(a){var b=a.url,c=a.row,d=a.col,e=a.sheetArea,f=this,g=f.getParent();g.options.allowAutoCreateHyperlink&&g.commandManager().execute({cmd:Q,sheetName:f.name(),url:b,row:c,col:d,sheetArea:e})}},d.Worksheet.$n(O,Y),Z={applyHyperlinkStyle:function(a){var b=a.style,c=a.sheet.getHyperlink(a.row,a.col,a.sheetArea);!fa(b)&&ea(b,c)},getCellTextHitInfo:function(a){var b,c=a.context.sheetArea,d=a.cellStyle,e=a.context,f=e.sheet,g=e.row,h=e.col;aa(f,g,h,c)&&!fa(d)&&(m(c)&&3!==c||!d||!a.cellRect||(b=f.getText(g,h,c),a.paddingHitInfo={row:g,col:h,x:a.x,y:a.y,sheetArea:c,sheet:f,isFocusAware:!0,isReservedLocation:ka(a.x,a.y,d,a.cellRect,e,b)}))},processMouseUpOnCellPadding:function(a){var b,c,e,f,g,h=a.sheet,i=a.cellStyle,j=a.row,k=a.col,l=a.sheetArea;h&&!h.isEditing()&&aa(h,j,k,l)&&!fa(i)&&a.isReservedLocation&&(b=h.Ws(),da(h),b&&(b.style.cursor=I),c=h.ITa.getHyperlink(j,k,l),c.isVisited=!0,e=c.command,m(e)||""===e||e===P?h.getParent().commandManager().execute({cmd:P,sheetName:h.name(),url:c.url,target:c.target}):"string"==typeof e?h.getParent().commandManager().execute({cmd:e,row:j,col:k,sheetName:h.name(),sheetArea:l}):"function"==typeof e&&e.call(q,h,j,k,l),f=h.getColumnCount(),g=new d.Range(j,(-1),1,f),h.repaint(h.getRangeRect(1,1,g)))},processMouseMoveOnCellPadding:function(a){var b,c,d=a.row,e=a.col,f=a.sheet,g=a.cellStyle,h=a.sheetArea;aa(f,d,e,h)&&!fa(g)&&(!f||f.isEditing()&&f.getActiveRowIndex()===d&&f.getActiveColumnIndex()===e||(b=f.Ws(),c=f.getHyperlink(d,e,h),a.isReservedLocation?b&&(ca(f,a,c.tooltip),b.style.cursor=F):(da(f),b&&(b.style.cursor=I))))},processMouseLeaveOnCellPadding:function(a){var b,c=a.sheet,d=a.row,e=a.col,f=a.sheetArea;da(c),aa(c,d,e,f)&&c&&(b=c.Ws(),b&&(b.style.cursor=I))},adjustEditorContainer:function(a){var b=a.cellStyle,c=a.context.row,d=a.context.col,e=a.context.sheet.getHyperlink(c,d);!fa(b)&&ea(b,e)}},l.$n(O,Z);function aa(a,b,c,d){return m(d)&&(d=3),!m(a.getHyperlink(b,c,d))}function ba(){var a=h(K);return j(a).css(w,x).css(y,0).css(C,2).css(D,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(E,H).css(G,J).css(z,"9pt Arial"),a}function ca(a,b,c){var d,e,f,g,h,i,k;c&&(d=a&&a.zo(),e=d.getElementsByClassName(L)[0],f=!1,m(e)&&(e=ba(),e.className=L,d.insertBefore(e,q),f=!0),g=j(e),!f&&g.isVisible()||(g.text(c),h=a.mm.bG(),i=h.left+b.x,k=h.top+b.y+20,g.css(B,k).css(A,i),g.show()))}function da(a){var b=a&&a.zo(),c=b.getElementsByClassName(L)[0];m(c)||j(c).hide()}function ea(a,b){m(b)||(b.drawUnderline&&(m(a.textDecoration)?a.textDecoration=1:1!==(1&a.textDecoration)&&(a.textDecoration+=1)),b.isVisited?b.visitedLinkColor===q?a.foreColor="rgba(0,0,0,0)":b.visitedLinkColor===p?a.foreColor=N:a.foreColor=o.bc(o.ec(b.visitedLinkColor)):m(b.linkColor)?b.linkColor===p&&a.foreColor||(a.foreColor=M):a.foreColor=o.bc(o.ec(b.linkColor)))}$={0:!0,1:!0,2:!0,3:!0,4:!0};function fa(a){if(a&&a.cellType){var b=a.cellType.typeName;if(!$[b])return!0}return!1}function ga(a,b,c,d,e,f,g){var h=0,i=0,j=a.width,k=a.height,l=ha(g);return l&&(j-=l),h=f=f||0,1===d?h=(j-b)/2:2===d&&(h=j-b-f),1===e?i=(k-c)/2:2===e&&(i=k-c),l&&(h+=l),{x:h,y:i}}function ha(a){var b={context:a,value:0};return l.ao(a.sheet,"getOutlineColumnOffset",b),b.value}function ia(a,b){var c=g(b),e=r(0,d.Vn.Xn(a,b,!0)),f=a.split(/\r\n|\r|\n/).length*c;return{x:0,y:0,width:e,height:f}}function ja(a,b,c,d,e,f,g){var h=ia(a,d),i=ga(e,h.width,h.height,b,c,f,g);return h.x=i.x,h.y=i.y,h}function ka(a,b,c,e,f,g){var h,j,k,l,n,o,p,q,r,t,u,v,w,x=f.sheet,y=x.yl;if(m(c))return!1;if(c.textOrientation)return!0;if(h=x.getValue(f.row,f.col,f.sheetArea),g||(g=x.getText(f.row,f.col,f.sheetArea)),!g)return!1;for(g=g.replace(/\s+/g," "),j=c&&c.font?c.font:y.Bl(),j=y.Cl(j),k=[g],l=la(c),c.wordWrap&&(k=d.Vn.Wn(g,e.width-3-l,j),g=k.join("\r\n")),n=c.hAlign,o=c.vAlign,3===n&&(n=i(n,h,c.formatter)),p=ja(g,n,o,j,e,l,f),q=e.y+p.y,r=0;r<k.length;r++)if(t=ja(k[r],n,o,j,e,l,f),u=e.x+t.x,v=s(u+t.width,e.x+e.width),w=q,q=s(w+t.height,e.y+e.height),u<=a&&a<v&&w<=b&&b<q)return!0;return!1}function la(a){return 8*(a.textIndent||0)}},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});